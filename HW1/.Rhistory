data1$headers
data1$header
head(data1)
dat1$Signed_in
head(dat1a$Signed_in)
head(data1$Signed_in)
head(data1$Signed_In)
data1$age_group <- cut(data$Age, c(-Inf,0,18,24,34,44,54,64,Inf))
data1$age_group <- cut(data1$Age, c(-Inf,0,18,24,34,44,54,64,Inf))
head(data1$age_group)
data1$CTR <- (data1$Clicks/data1$Impressions)
data1$CTR
head(data1$CTR)
head(data1)
install.packages("ggplot2")
summaryBy(Gender+Signed_In+Impressions+Clicks~age_group,data=data1)
install.packages("doBy")
library("doBy")
library("ggplot2")
siterange <- function(x){c(length(x), min(x), mean(x),max(x))}
summaryBy(Gender+Signed_In+Impressions+Clicks~age_group,data=data1)
summary <- summaryBy(Gender+Signed_In+Impressions+Clicks~age_group,data=data1)
summary
summaryBy(Age~age_group,data=data1,FUN=siterange)
ggplot(data1, aes(x=Impressions, fill=age_group)) + geom_histogram(binwidth=1)
ggplot(data1, aes(x=age_group, y=Impressions, fill=age_group)) + geom_boxplot()
ggplot(data1, aes(x=age_group, y=Impressions, fill=age_group)) + geom_density()
ggplot(data1, aes(x=Impressions, fill=age_group)) + geom_histogram(binwidth=1)
clear
ggplot(data1, aes(x=Impressions, fill=age_group)) + geom_density()
ggplot(data1, aes(x=Impressions, fill=age_group)) + geom_bar()
ggplot(data1, aes(x=Impressions, fill=age_group)) + geom_bar(binwidth=1)
ggplot(data1, aes(x=Impressions, y =Clicks, fill=age_group)) + geom_line()
ggplot(data1, aes(x=age_group, y=Impressions,fill=age_group))+geom_line()
ggplot(data1,aes(x=Clicks/Impressions, colour=age_group)) + geom_density()
ggplot(data1,aes(x=Clicks/Impressions, colour=age_group)) + geom_histogram(binwidth=1)
ggplot(data1,aes(x=Clicks/Impressions, fill=age_group)) + geom_histogram(binwidth=1)
ggplot(data1,aes(x=Clicks/Impressions, fill=age_group)) + geom_histogram()
ggplot(data1, aes(x=Impressions, fill=age_group)) + geom_histogram(binwidth=1)
summaru
summary
ggplot(summary, aes(x=Clicks, fill=age_group)) + geom_histogram()
ggplot(summary, aes(x=Clicks.mean, fill=age_group)) + geom_histogram()
ggplot(summary, aes(x=Clicks.mean, fill=age_group)) + geom_point()
ggplot(summary, aes(x=age_group, y= Clicks.mean, fill=age_group)) + geom_point()
ggplot(summary, aes(x=age_group, y= Clicks.mean/Impressions.mean, fill=age_group)) + geom_point()
data1$scode[data1$Impressions ==0] <- 'NoImps'
data1$scode[data1$Impressions > 0] <- 'Imps'
data1$scode[data1$Clicks > 0] <- "Clicks"
data1$scode
head(data1$scode)
head(data1)
data1$scode <- factor(data1$scode)
head(data1)
clen = function(x){c(length(x))}
etable <- summaryBy(Impressions~scode+Gender+agecat,data=data1,FUN=clen)
etable
etable <- summaryBy(Impressions~scode+Gender+age_group,data=data1,FUN=clen)
etable
ggplot(data = etable, aes(x=age_group, y = Impressions.clen)) + geom_point()
ggplot(data = etable, aes(x=age_group, y = Impressions.clen, colour=Gender)) + geom_point()
ggplot(data = etable, aes(x=age_group, y = Impressions.clen, colour=Gender+scode)) + geom_point()
ggplot(data = etable, aes(x=age_group, y = Impressions.clen, colour=(Gender,scode))) + geom_point()
ggplot(data = etable, aes(x=age_group, y = Impressions.clen, colour=scode))) + geom_point()
ggplot(data = etable, aes(x=age_group, y = Impressions.clen, colour=scode)) + geom_point()
ggplot(data = etable, aes(x=age_group, y = Impressions.clen, colour=scode, shape =Gender)) + geom_point()
ggplot(data = etable, aes(x=age_group, y = Impressions.clen, colour=scode, shape=Gender)) + geom_point()
etable$gender <- factor(data1$Gender)
etable$gender <- factor(etable$Gender)
etable
ggplot(data = etable, aes(x=age_group, y = Impressions.clen, colour=scode, shape =gender)) + geom_point()
summary
etable <- summaryBy(CTR~scode+Gender+age_group,data=data1,FUN=clen)
etable
data1
head(data1)
etable <- summaryBy(CTR~scode+Gender+age_group,data=data1,FUN=clen)
etable
ggplot(data = etable, aes(x=age_group, y = CTR.clen, colour=scode, shape =gender)) + geom_point()
etable <- summaryBy(Impressions~scode+Gender+age_group,data=data1,FUN=clen)
etable
etable <- summaryBy(Clicks~scode+Gender+age_group,data=data1,FUN=clen)
etable
summary
summary <- summaryBy(Age~age_group+Gender,data = data1, fun=siterange)
summary <- summaryBy(Age~age_group+Gender,data = data1, fun=clen)
summary <- summaryBy(Age~age_group+Gender,data = data1)
summary
summary <- summaryBy(CTR~age_group+Gender,data = data1)
summary
head(data1$CTR)
summary <- summaryBy(Clicks/Impressions~age_group+Gender,data = data1)
summary
summary <- summaryBy(CTR~age_group+Gender,data = data1)
ctr = function(x){x$Clicks/x$Impressions}
summary <- summaryBy(CTR~age_group+Gender,data = data1, FUN = ctr)
ctr = function(x){x.Clicks/x.Impressions}
summary <- summaryBy(CTR~age_group+Gender,data = data1, FUN = ctr)
summary <- summaryBy(Age~age_group,data = data1, FUN=siterange)
summary
summary(data1)
data1
cls
library(ggplot2)
library(doBy)
summaryBy(CTR~age_group, data=data1)
summaryBy(CTR~Clicks/Impressions, data=data1)
summaryBy(CTR~Clicks+Impressions, data=data1)
clear()
ggplot(subset(data1,Clicks>0), aes(x=Clicks/Impressions,colour=age_group)) + geom_density()
head(data1)
etable <-summaryBy(Impressions~scode+Gender+age_group, data=data1, FUN = clen)
etable
etable <-summaryBy(I~scode+Gender+age_group, data=data1, FUN = clen)
etable <-summaryBy(Impressions~scode+Gender+age_group, data=data1, FUN = clen)
ctr <- cummaryBy(CTR~scode+Gender+age_group,data=data1, FUN = clen)
ctr <- summaryBy(CTR~scode+Gender+age_group,data=data1, FUN = clen)
ctr
ctr <- summaryBy(CTR~scode+Gender+age_group,data=data1)
ctr
ctr <- summaryBy(CTR~scode+Gender+age_group,data=subset(data1, Clicks>0))
ctr
ggplot(data = data1, aes(x=ctr, fill=age_group, linetype=Gender))
ggplot(data = data1, aes(x=ctr, fill=age_group, linetype=Gender)) + geom_histogram()
ctr$gender <- factor(ctr$Gender)
ggplot(data = data1, aes(x=ctr, fill=age_group, linetype=gender)) + geom_histogram()
ggplot(data = ctr, aes(x=CTR.mean, fill=age_group, linetype=Gender))
ggplot(data = ctr, aes(x=CTR.mean, fill=age_group, linetype=Gender)) + geom_histogram
ggplot(data = ctr, aes(x=CTR.mean, fill=age_group, linetype=Gender)) + geom_histogram()
ggplot(data = ctr, aes(x=CTR.mean, fill=age_group, linetype=gender)) + geom_histogram()
ggplot(data = ctr, aes(x=CTR.mean, fill=age_group, shape=gender)) + geom_point()
ggplot(data = ctr, aes(x=age_group, y = CTR.mean, colour=gender)) + geom_point()
ag <- aggregate(. ~ CTR, data1, function(x) c(mean = mean(x), sd = sd(x)))
ag
ag <- aggregate(CTR, data1, function(x) c(mean = mean(x), sd = sd(x)))
ag <- aggregate(data$CTR, data1, function(x) c(mean = mean(x), sd = sd(x)))
ag <- aggregate(. ~ Gender + age_group + scode, data1, function(x) c(mean = mean(x), sd = sd(x)))
ag
ag <- aggregate(. ~ Gender + age_group + scode + Age + Signed_In, data1, function(x) c(mean = mean(x), sd = sd(x)))
ag
ag <- aggregate(. ~ Gender + age_group + scode + Signed_In, data1, function(x) c(mean = mean(x), sd = sd(x)))
ag
ag <- aggregate(. ~ Gender + age_group + Signed_In, data1, function(x) c(mean = mean(x), sd = sd(x)))
ag
ag$Gender <-factor(ag$Gender)
ggplot(data = ag, aes(x=age_group, y= CTR.sd, colour = Gender))
ggplot(data = ag, aes(x=age_group, y= CTR.sd, colour = Gender)) + geom_point()
ag
ggplot(data = ag, aes(x=age_group, y=CTR.sd, colour = Gender)) + geom_point()
ag$CTR.sd
View(ag)
ag
ag <- aggregate(. ~ Gender + age_group + Signed_In, data1, function(x) c(mean = mean(x), sd = sd(x)))
ag
ag$CTR.sd
ag$CTR
ag$CTR$sd
ag$CTR.sd
ag$CTR.mean
ag$CTR
ctr_sd = ag$CTR
View(ctr_sd)
ctr_sd$sd
ctr_sd[sd]
ctr_sd->sd
ctr_sd.sd
ctr_sd
ctr_sd$sd
ctr_sd['sd']
get_element(ctr_sd,"sd")
getElement(ctr_sd,"sd")
ctr_sd[0]
ctr_sd[0][sd]
ctr_sd[0][0]
ctr_sd[0][1]
ctr_sd[0][2]
clear
ag$CTR['sd']
ag$CTR
ag$CTR[1,]
ag$CTR[1,]['sd']
ag$CTR[:]['sd']
ag$CTR[,]['sd']
ag$CTR[.,.]['sd']
ag$CTR[.]['sd']
ag$CTR[]['sd']
ag$CTR[,]['sd']
ag$CTR[1]['sd']
ag$CTR[1,]['sd']
ag$CTR[1:15,]['sd']
ag$CTR[(1,),]['sd']
ag$CTR[1,]['sd']
ag$CTR[1]['sd']
ag$CTR[1,]['sd']
ag$CTR[2,]['sd']
ag$CTR[][]
ag$CTR[]['sd']
ag$CTR[][sd]
ag$CTR[]['sd']
ag$CTR[]
ag$CTR['sd']
ag$CTR[1,15]['sd']
ag$CTR[1:15,]['sd']
ag$CTR[1:15,][]
ag$CTR[1:15,]['mean']
ag$CTR[1:15,]
ag$CTR[]
ag$CTR
ag$CTR[>0]
ag$CTR[0]
ag$CTR[]
ag$CTR[1,]
ag$CTR[1,][sd]
ag$CTR[1,]['sd']
ag$CTR[2,]['sd']
sd(ag$CTR)
ggplot(data = ctr, aes(x=age_group, y = CTR.mean, colour=gender)) + geom_point()
ggplot(data = ctr, aes(x=age_group, y = CTR.mean, colour=gender,size=10)) + geom_point()
ggplot(data = ctr, aes(x=age_group, y = CTR.mean, colour=gender)) + geom_point()
users_under_18 <- data1[Age < 18]
haed(data1)
head(data1)
users_under_18 <- data1[data1$Age < 18]
data1[Age]
data1['Age']
users_under_18 <- data1['Age' < 18]
length(users_under_18)
users_under_18
data1
View(users_under_18)
View(users_under_18)
users_under_18 <- data1['Age' < 18]
users_under_18
length(data1['Age'<18])
data1.rows
data1.rows()
data1[which('Age' < 18)]
data1[which('Age' < 18),]
data1$Age
data1$Age < 0
users_under_18 = data1$Age[>0]
users_under_18 = subset(data1, Age < 18)
users_under_18
head
head(users_under_18)
length(data1)
nrow(data1)
nrow(subset(data1, age < 18))
nrow(subset(data1, Age < 18))
nrow(subset(data1, Age < 18))/nrow(data1)
ggplot(data = data1, aes(x=Age, color = age_group)) + geom_histogram()
ggplot(data = data1, aes(x=Age, fill = age_group)) + geom_histogram()
ggplot(data = data1, aes(x=Age, fill = age_group)) + geom_bar()
ggplot(data = data1, aes(x=Age, fill = age_group)) + geom_bar(binwidth=x)
ggplot(data = data1, aes(x=Age, fill = age_group)) + geom_bar(binwidth=1)
ggplot(data = data1, aes(x=age_group, fill = age_group)) + geom_bar(binwidth=1)
data
head(data)
data = read.csv(file = "~/CSCI 183/HW1/nyt1.csv")
haed(data)
head(data)
data_signedIn <- subset(data, data$Signed_In==1)
library(doBy)
#describe the user behavior.  They either Clicked, saw an add and DidNotClick, or NoAds were displayed
data_signedIn$category[data_signedIn$Impressions == 0] <- "NoAdd"
data_signedIn$category[data_signedIn$Impressions > 0] <- "DidNotClick"
data_signedIn$category[data_signedIn$Clicks > 0] <- "Clicked"
cat_summary <- summaryBy(category ~ age_group + Gender,
data= data_signedIn, FUN = function(x){length(x)})
cat_summary
data_signedIn$age_group <- cut(data$Age, c(-Inf, 0, 18,24,34,54,64,Inf))
data_signedIn$age_group <- cut(data_signedIn$Age, c(-Inf, 0, 18,24,34,54,64,Inf))
data_signedIn
length(data_signedIn)
nrow(data_signedIn)
nrow(data)
cat_summary <- summaryBy(category ~ age_group + Gender,
data= data_signedIn, FUN = function(x){length(x)})
cat_summary
len = function(x){length(x)}
cat_summary <- summaryBy(category ~ age_group + Gender,
data= data_signedIn, FUN = len)
cat_summary
cat_summary <- summaryBy(category ~ age_group + Gender + category,
data= data_signedIn, FUN = len)
cat_summary
cat_summary <- summaryBy(category ~ age_group + Gender,
data= data_signedIn, FUN = len)
cat_summary <- summaryBy(category ~ age_group + Gender + category,
data= data_signedIn, FUN = len)
ggplot(data=cat_summary, aes(x=category, y=category.len, color = age_group)) + geom_histogram(stat="identity")
library(ggplot2)
ggplot(data=cat_summary, aes(x=category, y=category.len, color = age_group)) + geom_histogram(stat="identity")
ggplot(data=cat_summary, aes(x=category, y=category.len, fill = age_group)) + geom_histogram(stat="identity")
ggplot(data=cat_summary, aes(x=category, y=category.len, fill = age_group)) + geom_histogram(stat="identity", aes(y=..count../sum(..count..)))
ggplot(data=cat_summary, aes(x=category, y=category.len/sum(categor.len), fill = age_group)) + geom_histogram(stat="identity")
ggplot(data=cat_summary, aes(x=category, y=category.len/sum(category.len), fill = age_group)) + geom_histogram(stat="identity")
ggplot(data=cat_summary, aes(x=category, y=category.len/sum(category.len), fill = age_group)) + geom_histogram(position="dodge"stat="identity")
ggplot(data=cat_summary, aes(x=category, y=category.len/sum(category.len), fill = age_group)) + geom_histogram(position="dodge", stat="identity")
ggplot(data=cat_summary, aes(x=category, y=category.len/sum(category.len), fill = age_group)) + geom_histogram(stat="identity")
summaryBy(age_group, data=data_signedIn, FUN=len)
head(data_signedIn)
summaryBy(age_group, data=data_signedIn, FUN=len)
ggplot(data=data_signedIn, aes(x=age_group, color=age_group)) + geom_histogram()
ggplot(data=data_signedIn, aes(x=age_group, color=age_group)) + geom_histogram(aes(y=y=..count../sum(..count..)))
ggplot(data=data_signedIn, aes(x=age_group, color=age_group)) + geom_histogram(aes(y=..count../sum(..count..)))
ggplot(data=cat_summary, aes(x=category, y=category.len/sum(category.len), fill = age_group)) + geom_histogram(position="dodge", stat="identity")
y = category.len/sum(category.len)
y = cat_summary$category.len/sum(cat_summary$category.len)
y
sum(y)
ggplot(data=data_signedIn, aes(x=age_group, color=age_group)) + geom_histogram(aes(y=..count../sum(..count..)))
melt(cat_summary)
library("reshape")
melt(cat_summary)
source('~/.active-rstudio-document')
savehistory("~/CSCI 183/hist.Rhistory")
#merged_ctr will now have all data for signed in users
#create one plot for all male data for each age group, and one for all female data
male_ctr_plot = ggplot(data=subset(merged_ctr,merged_ctr$Gender ==0),
aes(x=as.Date(timestamp), y= value, fill=age_group))
+ geom_bar(position = "dodge", stat="identity")
+ ggtitle("Average Click Through Rate of Males across all Age Groups")
female_ctr_plot = ggplot(data=subset(merged_ctr,merged_ctr$Gender ==1),
aes(x=as.Date(timestamp), y= value, fill=age_group))
+ geom_bar(position = "dodge", stat="identity")
+ ggtitle("Average Click Through Rate of Females across all Age Groups")
ag_mean = aggregate(value ~ Gender + age_group,  merged_ctr, function(x) c(mean = mean(x)))
ag_mean_plot = ggplot(data=ag_mean,
aes(x = age_group, y = value, fill=factor(Gender, labels=c("Male","Female"))))
+ geom_bar(stat="identity", position="dodge")
+  guides(fill=guide_legend(title="Gender"))
+ ggtitle("Average CTR per Age Group")
#save plots
ggsave("~/CSCI 183/HW1/male_ctr.png",male_ctr_plot)
ggsave("~/CSCI 183/HW1/female_ctr.png",female_ctr_plot)
ggsave("~/CSCI 183/HW1/ag_signed_mean.png",ag_mean_plot)
#examine the breakdown of user categories over time based on gender and age_group
#merged_ctr will now have all data for signed in users
#create one plot for all male data for each age group, and one for all female data
male_ctr_plot = ggplot(data=subset(merged_ctr,merged_ctr$Gender ==0),
aes(x=as.Date(timestamp), y= value, fill=age_group))
+ geom_bar(position = "dodge", stat="identity")
+ ggtitle("Average Click Through Rate of Males across all Age Groups")
female_ctr_plot = ggplot(data=subset(merged_ctr,merged_ctr$Gender ==1),
aes(x=as.Date(timestamp), y= value, fill=age_group))
+ geom_bar(position = "dodge", stat="identity")
+ ggtitle("Average Click Through Rate of Females across all Age Groups")
ag_mean = aggregate(value ~ Gender + age_group,  merged_ctr, function(x) c(mean = mean(x)))
ag_mean_plot = ggplot(data=ag_mean,
aes(x = age_group, y = value, fill=factor(Gender, labels=c("Male","Female"))))
+ geom_bar(stat="identity", position="dodge")
+  guides(fill=guide_legend(title="Gender"))
+ ggtitle("Average CTR per Age Group")
#save plots
ggsave("~/CSCI 183/HW1/male_ctr.png",male_ctr_plot)
ggsave("~/CSCI 183/HW1/female_ctr.png",female_ctr_plot)
ggsave("~/CSCI 183/HW1/ag_signed_mean.png",ag_mean_plot)
#examine the breakdown of user categories over time based on gender and age_group
#merged_ctr will now have all data for signed in users
#create one plot for all male data for each age group, and one for all female data
male_ctr_plot = ggplot(data=subset(merged_ctr,merged_ctr$Gender ==0),
aes(x=as.Date(timestamp), y= value, fill=age_group))
+ geom_bar(position = "dodge", stat="identity")
+ ggtitle("Average Click Through Rate of Males across all Age Groups")
female_ctr_plot = ggplot(data=subset(merged_ctr,merged_ctr$Gender ==1),
aes(x=as.Date(timestamp), y= value, fill=age_group))
+ geom_bar(position = "dodge", stat="identity")
+ ggtitle("Average Click Through Rate of Females across all Age Groups")
ag_mean = aggregate(value ~ Gender + age_group,  merged_ctr, function(x) c(mean = mean(x)))
ag_mean_plot = ggplot(data=ag_mean,
aes(x = age_group, y = value, fill=factor(Gender, labels=c("Male","Female"))))
+ geom_bar(stat="identity", position="dodge")
+  guides(fill=guide_legend(title="Gender"))
+ ggtitle("Average CTR per Age Group")
#save plots
ggsave("~/CSCI 183/HW1/male_ctr.png",male_ctr_plot)
ggsave("~/CSCI 183/HW1/female_ctr.png",female_ctr_plot)
ggsave("~/CSCI 183/HW1/ag_signed_mean.png",ag_mean_plot)
#examine the breakdown of user categories over time based on gender and age_group
male_ctr_plot = ggplot(data=subset(merged_ctr,merged_ctr$Gender ==0),
aes(x=as.Date(timestamp), y= value, fill=age_group)) + geom_bar(position = "dodge", stat="identity") + ggtitle("Average Click Through Rate of Males across all Age Groups")
female_ctr_plot = ggplot(data=subset(merged_ctr,merged_ctr$Gender ==1),
aes(x=as.Date(timestamp), y= value, fill=age_group)) + geom_bar(position = "dodge", stat="identity") + ggtitle("Average Click Through Rate of Females across all Age Groups")
ag_mean = aggregate(value ~ Gender + age_group,  merged_ctr, function(x) c(mean = mean(x)))
ag_mean_plot = ggplot(data=ag_mean,
aes(x = age_group, y = value, fill=factor(Gender, labels=c("Male","Female")))) + geom_bar(stat="identity", position="dodge") +  guides(fill=guide_legend(title="Gender"))+ ggtitle("Average CTR per Age Group")
#save plots
ggsave("~/CSCI 183/HW1/male_ctr.png",male_ctr_plot)
ggsave("~/CSCI 183/HW1/female_ctr.png",female_ctr_plot)
ggsave("~/CSCI 183/HW1/ag_signed_mean.png",ag_mean_plot)
#examine the breakdown of user categories over time based on gender and age_group
merged_ctr
merged_cat
library("doBy")
library("ggplot")
library("ggplot2")
catSum = summaryBy(category.len ~ age_group + Gender, data= merged_cat, FUN=len)
catSum
sum = function(x){sum(x)}
catSum = summaryBy(category.len ~ age_group + Gender, data= merged_cat, FUN=sum)
catSum = aggregate(category.len ~ age_group + Gender, data=merged_cat, sum)
rm rum
rm sum
remove(sum)
catSum = aggregate(category.len ~ age_group + Gender, data=merged_cat, sum)
catSum
source('~/CSCI 183/HW1/hw1.R')
source('~/CSCI 183/HW1/hw1.R')
View(merged_ctr)
View(merged_ctr)
merged_cat
head(merged_cat)
ggplot(data=merged_cat, aes(x=category, fill = age_group)) + geom_histogram()
ggplot(data=merged_cat, aes(x=category, fill = age_group)) + geom_histogram(position="dodge")
melt(cat_summary, id=c("age_group", "Gender", "category"))
melt_cat = summaryBy(category.len ~ age_group + Gender + category, data=merged_cat)
melt_cat
ggplot(data=merged_cat, aes(x=category, y=category.len, fill = age_group)) + geom_histogram(position="dodge", stat="identity")
ggplot(data=merged_cat, aes(x=category, y=category.len/sum(category.len), fill = age_group)) + geom_histogram(position="dodge", stat="identity")
y = category.len/sum(category.len)
y = merged_cat$category.len/sum(merged_cat$category.len)
y
y.sum
sum(y)
ggplot(data=merged_cat, aes(x=category, y=category.len, fill = age_group, color=Gender)) + geom_histogram(position="dodge", stat="identity")
ggplot(data=merged_cat, aes(x=category, y=category.len, fill = age_group, color=factor(Gender)) + geom_histogram(position="dodge", stat="identity")
ggplot(data=merged_cat, aes(x=category, y=category.len, fill = age_group, color=factor(Gender))) + geom_histogram(position="dodge", stat="identity")
ggplot(data=merged_cat, aes(x=category, y=category.len, fill = age_group) + geom_histogram(position="dodge", stat="identity")
clear
ggplot(data=merged_cat, aes(x=category, y=category.len, fill = age_group)) + geom_histogram(position="dodge", stat="identity")
ggplot(data=merged_cat, aes(x=category, y=category.len, fill = age_group, linetype=Gender)) + geom_histogram(position="dodge", stat="identity")
ggplot(data=merged_cat, aes(x=category, y=category.len, fill = age_group, linetype=factor(Gender)) + geom_histogram(position="dodge", stat="identity")
ggplot(data=merged_cat, aes(x=category, y=category.len, fill = age_group, linetype=factor(Gender))) + geom_histogram(position="dodge", stat="identity")
ggplot(data=merged_cat, aes(x=category, y=category.len, fill = age_group)) + geom_histogram(position="dodge", stat="identity")
sumCat = summaryBy(cateogry.len ~ age_group + category)
sumCat = summaryBy(cateogry.len ~ age_group + category, data = merged_cat)
sumCat = summaryBy(category.len ~ age_group + category, data = merged_cat)
sumCat
sumCat = summaryBy(category.len ~ age_group + category, data = merged_cat, FUN = sum)
sumCat
ggplot(data=catSum, aes(x=category, y=category.len.sum, fill = age_group)) + geom_histogram(position="dodge", stat="identity")
ggplot(data=sumCat, aes(x=category, y=category.len.sum, fill = age_group)) + geom_histogram(position="dodge", stat="identity")
ggplot(data=sumCat, aes(x=category, y=category.len.sum/sum(category.len.sum), fill = age_group)) + geom_histogram(position="dodge", stat="identity")
ggplot(data=sumCat, aes(x=category, y=category.len.sum/sum(category.len.sum), fill = age_group)) + geom_histogram(position="dodge", stat="identity") + xlab("Frequency") +ggtitle("Frequency By Category and Age Group")
ggplot(data=sumCat, aes(x=category, y=category.len.sum/sum(category.len.sum), fill = age_group)) + geom_histogram(position="dodge", stat="identity") + ylab("Frequency") + xlab("Category") +ggtitle("Frequency By Category and Age Group")
merged_cat
catGenderSum = summaryBy(category.len ~ Gender + age_group + category, data = merged_cat, FUN = sum)
catGenderSum
ggplot(data=catGenderSum, aes(x=category, y=category.len.sum/sum(category.len.sum), fill = age_group, linetype=Gender)) + geom_histogram(position="dodge", stat="identity") + ylab("Frequency") + xlab("Category") +ggtitle("Frequency By Category and Age Group")
ggplot(data=catGenderSum, aes(x=category, y=category.len.sum/sum(category.len.sum), fill = age_group, linetype=factor(Gender))) + geom_histogram(position="dodge", stat="identity") + ylab("Frequency") + xlab("Category") +ggtitle("Frequency By Category and Age Group")
ggplot(data=catGenderSum, aes(x=category, y=category.len.sum/sum(category.len.sum), fill = age_group, color=factor(Gender),linetype=factor(Gender))) + geom_histogram(position="dodge", stat="identity") + ylab("Frequency") + xlab("Category") +ggtitle("Frequency By Category and Age Group")
catGenderSum = summaryBy(category.len ~ Gender+ category, data = merged_cat, FUN = sum)
ggplot(data=catGenderSum, aes(x=category, y=category.len.sum/sum(category.len.sum), fill = Gender)) + geom_histogram(position="dodge", stat="identity") + ylab("Frequency") + xlab("Category") +ggtitle("Frequency By Category and Age Group")
ggplot(data=catGenderSum, aes(x=category, y=category.len.sum/sum(category.len.sum), fill = factor(Gender))) + geom_histogram(position="dodge", stat="identity") + ylab("Frequency") + xlab("Category") +ggtitle("Frequency By Category and Age Group")
ggplot(data=catGenderSum, aes(x=category, y=category.len.sum/sum(category.len.sum), fill = factor(Gender))) + geom_histogram(position="dodge", stat="identity") + ylab("Frequency") + xlab("Category") +ggtitle("Frequency By Category and Gender")
ggplot(data=catGenderSum, aes(x=category, y=category.len.sum/sum(category.len.sum), fill = factor(Gender))) + geom_histogram(position="dodge", stat="identity") + ylab("Frequency") + xlab("Category") +ggtitle("Frequency By Category and Gender")
catGenderSum = summaryBy(category.len ~ Gender+ age_group + category, data = merged_cat, FUN = sum)
catGenderSum
clear
ggplot(data=catGenderSum, aes(x=category, y=category.len.sum/sum(category.len.sum), fill = factor(Gender))) + geom_histogram(position="dodge", stat="identity") + ylab("Frequency") + xlab("Category") +ggtitle("Frequency By Category and Age Group")
catGenderSum <- summaryBy(category.len ~ Gender+ category, data = merged_cat, FUN = sum)
ggplot(data=catGenderSum, aes(x=category, y=category.len.sum/sum(category.len.sum), fill = age_group, linestyle=factor(Gender), color=factor(Gender))) + geom_histogram(position="dodge", stat="identity") + ylab("Frequency") + xlab("Category") +ggtitle("Frequency By Category and Age Group")
catGenderSum
catGenderSum <- summaryBy(category.len ~ Gender + age_group + category, data = merged_cat, FUN = sum)
ggplot(data=catGenderSum, aes(x=category, y=category.len.sum/sum(category.len.sum), fill = age_group, linestyle=factor(Gender), color=factor(Gender))) + geom_histogram(position="dodge", stat="identity") + ylab("Frequency") + xlab("Category") +ggtitle("Frequency By Category and Age Group")
ggplot(data=catGenderSum, aes(x=category, y=category.len.sum/sum(category.len.sum), fill = age_group, linetype=factor(Gender), color=factor(Gender))) + geom_histogram(position="dodge", stat="identity") + ylab("Frequency") + xlab("Category") +ggtitle("Frequency By Category and Age Group")
ggplot(data=catGenderSum, aes(x=category, y=category.len.sum/sum(category.len.sum), fill = age_group, linetype=factor(Gender), color=factor(Gender))) + geom_histogram(position="dodge", stat="identity") + ylab("Frequency") + xlab("Category") +ggtitle("Frequency By Category, Age Group and Gender")
clicked_users = subset(merged_cat, merged_cat$category == "Clicked")
clicked_users
clickedSum <- summaryBy(category.len ~ age_group + Gender, data = clicked_users, FUN = sum)
clickedSum
savehistory("~/CSCI 183/hist.Rhistory")
load("~/.RData")
catAgeGenderPlot + guides(fill=guide_leged(title="Gender")) + aes(fill=factor(Gender,labels=c("Male","Female")))
library(ggplot2)
catAgeGenderPlot + guides(fill=guide_leged(title="Gender")) + aes(fill=factor(Gender,labels=c("Male","Female")))
catAgeGenderPlot + guides(fill=guide_legend(title="Gender")) + aes(fill=factor(Gender,labels=c("Male","Female")))
catAgeGenderPlot <- ggplot(data=catAgeGenderSum, aes(x=category, y=category.len.sum/sum(category.len.sum), fill = age_group, linetype=factor(Gender, labels=c("Male","Female")), color=factor(Gender,labels=c("Male","Female")))) + geom_histogram(position="dodge", stat="identity") + ylab("Frequency") + xlab("Category") +ggtitle("Frequency By Category, Age Group and Gender")
print(catAgeGenderPlot)
catAgeGenderPlot <- ggplot(data=catAgeGenderSum, aes(x=category, y=category.len.sum/sum(category.len.sum), fill = age_group, linetype=factor(Gender, labels=c("Male","Female")), color=factor(Gender,labels=c("Male","Female")))) + geom_histogram(position="dodge", stat="identity") + ylab("Frequency") + xlab("Category") +ggtitle("Frequency By Category, Age Group and Gender") + guides(fill=guide_legend(title="Gender"))
print(catAgeGenderPlot)
catAgeGenderPlot <- ggplot(data=catAgeGenderSum, aes(x=category, y=category.len.sum/sum(category.len.sum), fill = age_group, linetype=factor(Gender, labels=c("Male","Female")), color=factor(Gender,labels=c("Male","Female")))) + geom_histogram(position="dodge", stat="identity") + ylab("Frequency") + xlab("Category") +ggtitle("Frequency By Category, Age Group and Gender") + guides(fill=guide_legend[2](title="Gender"))
Genders = factor(catAgeGenderSum$Gender, labels=C("Male","Female"))
catAgeGenderPlot <- ggplot(data=catAgeGenderSum, aes(x=category, y=category.len.sum/sum(category.len.sum), fill = age_group, linetype=factor(Gender, labels=c("Male","Female")), color=factor(Gender,labels=c("Male","Female")))) + geom_histogram(position="dodge", stat="identity") + ylab("Frequency") + xlab("Category") +ggtitle("Frequency By Category, Age Group and Gender") + scale_colour_discrete(name  ="Payer",
breaks=c("Female", "Male"),
labels=c("Woman", "Man")) +
scale_shape_discrete(name  ="Payer",
breaks=c("Female", "Male"),
labels=c("Woman", "Man"))
print(catAgeGenderPlot)
catAgeGenderPlot <- ggplot(data=catAgeGenderSum, aes(x=category, y=category.len.sum/sum(category.len.sum), fill = age_group, linetype=factor(Gender, labels=c("Male","Female")), color=factor(Gender,labels=c("Male","Female")))) + geom_histogram(position="dodge", stat="identity") + ylab("Frequency") + xlab("Category") +ggtitle("Frequency By Category, Age Group and Gender") + scale_linetype_discrete(name="Gender", breaks=c("Male", "Female"),                                                                                                                                                                                                              labels=c("Woman", "Man"))
print(catAgeGenderPlot)
catAgeGenderPlot <- ggplot(data=catAgeGenderSum, aes(x=category, y=category.len.sum/sum(category.len.sum), fill = age_group, linetype=factor(Gender, labels=c("Male","Female")), color=factor(Gender,labels=c("Male","Female")))) + geom_histogram(position="dodge", stat="identity") + ylab("Frequency") + xlab("Category") +ggtitle("Frequency By Category, Age Group and Gender") + scale_linetype_discrete(name="Gender", breaks=c("Male", "Female"),                                                                                                                                                                                                              labels=c("Woman", "Man")) + scale_colour_discrete(name="Gender", breaks=c("Male", "Female"),                                                                                                                                                                                                              labels=c("Woman", "Man"))
print(catAgeGenderPlot)
catAgeGenderPlot <- ggplot(data=catAgeGenderSum, aes(x=category, y=category.len.sum/sum(category.len.sum), fill = age_group, linetype=factor(Gender, labels=c("Male","Female")), color=factor(Gender,labels=c("Male","Female")))) + geom_histogram(position="dodge", stat="identity") + ylab("Frequency") + xlab("Category") +ggtitle("Frequency By Category, Age Group and Gender") + scale_linetype_discrete(name="Gender", breaks=c("Male", "Female"),                                                                                                                                                                                                              labels=c("Male", "Female")) + scale_colour_discrete(name="Gender", breaks=c("Male", "Female"),                                                                                                                                                                                                              labels=c("Male", "Female"))
print(catAgeGenderPlot)
catGenderPlot + scale_fill_discrete((name="Gender", breaks=c("Male", "Female"),                                                                                                                                                                                                              labels=c("Male", "Female")))
catGenderPlot + scale_fill_discrete(name="Gender", breaks=c("Male", "Female"),                                                                                                                                                                                                              labels=c("Male", "Female"))
catGenderPlot <- ggplot(data=catGenderSum, aes(x=category, y=category.len.sum/sum(category.len.sum), fill = factor(Gender))) + geom_histogram(position="dodge", stat="identity") + ylab("Frequency") + xlab("Category") +ggtitle("Frequency By Category and Gender") + scale_fill_discrete(name="Gender", breaks=c("Male", "Female"),                                                                                                                                                                                                              labels=c("Male", "Female"))
print(catGenderPlot)
catGenderPlot <- ggplot(data=catGenderSum, aes(x=category, y=category.len.sum/sum(category.len.sum), fill = factor(Gender))) + geom_histogram(position="dodge", stat="identity") + ylab("Frequency") + xlab("Category") +ggtitle("Frequency By Category and Gender")
print(catGenderPlot)
catGenderPlot <- ggplot(data=catGenderSum, aes(x=category, y=category.len.sum/sum(category.len.sum), fill = factor(Gender))) + geom_histogram(position="dodge", stat="identity") + ylab("Frequency") + xlab("Category") +ggtitle("Frequency By Category and Gender") + guides(fill=guide_legend, title="Gender")
print(catGenderPlot)
catGenderPlot <- ggplot(data=catGenderSum, aes(x=category, y=category.len.sum/sum(category.len.sum), fill = factor(Gender))) + geom_histogram(position="dodge", stat="identity") + ylab("Frequency") + xlab("Category") +ggtitle("Frequency By Category and Gender") + guides(fill=guide_legend, title="Gender")
print(catGenderPlot)
catGenderPlot <- ggplot(data=catGenderSum, aes(x=category, y=category.len.sum/sum(category.len.sum), fill = factor(Gender))) + geom_histogram(position="dodge", stat="identity") + ylab("Frequency") + xlab("Category") +ggtitle("Frequency By Category and Gender")
print(catGenderPlot)
catGenderPlot + guides(guide_legend(title="Gender"))
male_ctr_plot + ylab("CTR") + xlab("Date")
female_ctr_plot + ylab("CTR") + xlab("Date")
